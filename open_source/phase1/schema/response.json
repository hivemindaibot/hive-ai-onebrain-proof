{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://hive.onebrain.dev/schema/proof/response-0.1.0.json",
  "title": "Proof IO Query Response",
  "description": "Schema for the Phase 1 proof `/io/query` response payload.",
  "x-version": "0.1.0",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "ok",
    "decision",
    "answer",
    "citations",
    "errors",
    "warnings",
    "run_id",
    "probe_findings",
    "validation"
  ],
  "properties": {
    "ok": {"type": "boolean"},
    "decision": {"type": "string", "enum": ["accept", "reject", "quarantine"]},
    "answer": {"type": "string"},
    "citations": {
      "type": "array",
      "items": {
        "type": "object",
        "additionalProperties": false,
        "required": ["id", "sha256", "evidence"],
        "properties": {
          "id": {"type": "string", "minLength": 1},
          "sha256": {"type": "string", "pattern": "^[0-9a-f]{64}$"},
          "evidence": {"type": "string", "minLength": 1}
        }
      }
    },
    "confidence": {"type": ["number", "null"], "minimum": 0, "maximum": 1},
    "errors": {
      "type": "array",
      "items": {"type": "string"}
    },
    "warnings": {
      "type": "array",
      "items": {"type": "string"}
    },
    "run_id": {"type": "string", "minLength": 1},
    "probe_findings": {"type": ["object", "null"]},
    "validation": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "ok",
        "decision",
        "errors",
        "warnings",
        "latency_seconds",
        "usage",
        "citations_hash",
        "probe_findings"
      ],
      "properties": {
        "ok": {"type": "boolean"},
        "decision": {"type": "string", "enum": ["accept", "reject", "quarantine"]},
        "errors": {
          "type": "array",
          "items": {"type": "string"}
        },
        "warnings": {
          "type": "array",
          "items": {"type": "string"}
        },
        "latency_seconds": {"type": "number", "minimum": 0},
        "usage": {"type": "object", "additionalProperties": true},
        "citations_hash": {"type": ["string", "null"]},
        "probe_findings": {"type": ["object", "null"]}
      }
    }
  }
}
